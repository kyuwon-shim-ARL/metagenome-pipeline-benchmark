### **연구 제안서**

**1. 연구 과제명**

환경 메타지놈 분석 파이프라인의 다차원적 성능 평가 및 최적화 가이드라인 구축

**2. 연구 배경 및 필요성**

차세대 염기서열 분석(NGS) 기술의 발전으로 환경 샘플 내 미생물 군집을 직접 분석하는 메타지노믹스 연구가 폭발적으로 증가했습니다. 이에 따라 `nf-core/mag`와 같은 표준화된 파이프라인이 등장하여 분석의 재현성을 높였지만, 파이프라인 내부에 사용되는 수많은 분석 도구(e.g., 어셈블러, 비닝 툴)의 조합이 결과의 정확도와 효율성에 미치는 영향은 여전히 명확하지 않습니다.

연구자들은 자신의 데이터와 연구 목적에 어떤 도구 조합이 최적인지 알기 어려우며, 이는 분석 결과의 신뢰도 저하와 자원 낭비로 이어질 수 있습니다. 따라서 **정량적이고 재현 가능한 벤치마킹 프레임워크**를 통해 각 분석 단계의 성능을 체계적으로 평가하고, 이를 바탕으로 한 명확한 가이드라인을 제시하는 연구가 시급합니다.

본 연구는 **정확성(Accuracy)**과 **강건성(Robustness)**이라는 두 가지 핵심 축을 기준으로 메타지놈 분석 파이프라인을 종합적으로 평가하여, 연구자들이 데이터 특성과 연구 목적에 맞는 최적의 분석 전략을 수립할 수 있도록 지원하고자 합니다.

**3. 연구 목표**

본 연구의 최종 목표는 환경 메타지놈 분석 파이프라인의 성능을 다각적으로 평가하고, 그 결과를 바탕으로 연구자들이 쉽게 따라 할 수 있는 **실용적인 최적화 가이드라인**을 제시하는 것입니다.

이를 달성하기 위한 세부 목표는 다음과 같습니다.

1. **MAG(Metagenome-Assembled Genome) 구조적 무결성**에 대한 정량적 벤치마킹 수행
    
2. **기능 및 계통 주석의 정확도**에 대한 다운스트림 분석 벤치마킹 수행
    
3. **실제 환경 데이터에 대한 파이프라인의 강건성 및 효율성** 평가
    

**4. 연구 내용 및 방법**

**4.1. [1단계] 정확성 평가: '정답'을 아는 인공 군집 데이터(CAMI) 활용**

이 단계는 통제된 환경의 '모의고사'와 같습니다. 파이프라인의 이론적인 최대 성능과 정확도를 측정합니다.

- **사용 데이터**: **CAMI-2 "Mouse Gut" 데이터셋** (High-complexity, Ground Truth 제공)
    
- **분석 방법**:
    
    1. `nf-core/mag` 파이프라인을 기반으로, 주요 파라미터를 변경하며 여러 조합을 테스트합니다.
        
        - **어셈블러 조합**: `MEGAHIT` vs `metaSPAdes`
            
        - **비닝 툴 조합**: `MetaBAT2` vs `MaxBin2` vs `CONCOCT`
            
    2. **구조적 무결성 평가**: 생성된 MAG를 **AMBER**와 **CheckM**을 사용하여 정답 데이터와 비교하고, 주요 지표(Completeness, Contamination, Precision, Recall, F1-score)를 정량화합니다.
        
    3. **다운스트림 정확도 평가**:
        
        - **계통 분석**: **GTDB-Tk**를 사용하여 MAG의 계통을 분류하고, 정답과 비교하여 **분류 수준(Rank)별 정확도**를 계산합니다.
            
        - **기능 분석**: **EggNOG-mapper**를 사용하여 기능 유전자를 주석하고, 원본 균주의 기능 정보와 비교하여 **정밀도와 재현율**을 계산합니다.
            

**4.2. [2단계] 강건성 평가: '정답' 없는 실제 환경 데이터(MetaSUB) 활용**

이 단계는 예측 불가능한 '실제 도로 주행'과 같습니다. 1단계에서 검증된 우수 파이프라인이 실제 환경의 복잡성을 얼마나 잘 처리하는지 평가합니다.

- **사용 데이터**: **MetaSUB 프로젝트** 데이터 중 환경적 특성이 다른 3종의 샘플 선정
    
- **분석 방법**:
    
    1. 1단계에서 **정확도와 자원 효율성을 고려하여 선정한 상위 3개의 파이프라인 조합**을 실제 데이터에 적용합니다.
        
    2. **강건성 평가**: 파이프라인이 예기치 않은 데이터(숙주 오염 등)에 의해 중단 없이 안정적으로 완료되는지 확인합니다.
        
    3. **효율성 평가**: `nf-core/benchmark` 또는 Nextflow 실행 리포트를 활용하여 각 파이프라인 조합의 **실행 시간, 최대 메모리 사용량, CPU 사용량**을 정밀하게 측정하고 비교합니다.
        

**5. 기대 효과 및 구체적 산출물**

본 연구를 통해 연구자들이 분석 파이프라인을 '블랙박스'처럼 사용하는 것에서 벗어나, 데이터와 목적에 근거하여 정보에 입각한 선택을 할 수 있도록 지원합니다.

- **구체적 산출물**:
    
    1. **종합 벤치마킹 리포트 (PDF)**
        
        - 모든 파이프라인 조합의 성능 평가 결과를 표와 그래프로 시각화하여 제시
            
        - 정확도 지표(F1-score 등)와 효율성 지표(메모리, 시간) 간의 트레이드오프 분석 포함
            
        - 각 툴의 장단점 및 특정 조건에서의 유용성에 대한 심층 분석 수록
            
    2. **메타지놈 분석을 위한 베스트 프랙티스 가이드 (Markdown, 웹페이지)**
        
        - 리포트의 핵심 결과를 요약하여 연구자들이 쉽게 이해할 수 있도록 정리
            
        - "최고의 정확도를 원한다면 (자원 충분 시) → **조합 A**"
            
        - "제한된 자원에서 합리적인 결과를 원한다면 → **조합 B**" 와 같은 시나리오 기반의 명확한 추천안 제시
            
    3. **재현 가능한 분석 코드 및 설정 파일 (GitHub Repository)**
        
        - 본 벤치마킹에 사용된 모든 Nextflow 스크립트, 설정 파일, 결과 분석 코드를 공개
            
        - 다른 연구자들이 동일한 벤치마크를 직접 재현하거나, 자신의 데이터에 맞게 수정하여 활용할 수 있도록 지원